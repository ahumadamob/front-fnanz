<section class="ga-card dashboard-card">
  <header class="ga-card__header">
    <div>
      <p class="ga-card__eyebrow">Monitoreo de plataforma</p>
      <h2>Estado de microservicios</h2>
    </div>
    <div class="ga-card__actions">
      <button type="button" class="ga-button ga-button--ghost">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 6v6l3 3" />
          <path d="M12 3a9 9 0 1 0 9 9" />
        </svg>
        Historial
      </button>
      <button type="button" class="ga-button" (click)="refresh()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="23 4 23 10 17 10" />
          <polyline points="1 20 1 14 7 14" />
          <path d="M3.51 9a9 9 0 0 1 14.13-3.36L23 10" />
          <path d="M20.49 15a9 9 0 0 1-14.13 3.36L1 14" />
        </svg>
        Actualizar
      </button>
    </div>
  </header>

  <p class="ga-card__meta">Última actualización: {{ lastRefresh() | date: 'medium' }}</p>

  <div class="ga-card__legend">
    <span class="ga-status ga-status--up">Operativo</span>
    <span class="ga-status ga-status--degraded">Parcial</span>
    <span class="ga-status ga-status--down">Caído</span>
  </div>

  <ng-container *ngIf="healthSnapshot$ | async as snapshot; else loading">
    <div class="ga-service-grid">
      <article class="ga-service" *ngFor="let service of snapshot">
        <header class="ga-service__header">
          <div>
            <h3>{{ service.name }}</h3>
            <p class="ga-service__meta">Último chequeo: {{ service.lastCheckedAt | date: 'medium' }}</p>
          </div>
          <span [ngClass]="resolveStatusClass(service.status)">
            {{ service.status }}
          </span>
        </header>
        <p class="ga-service__notes" *ngIf="service.notes as notes">{{ notes }}</p>
      </article>
    </div>
  </ng-container>

  <ng-template #loading>
    <p class="ga-card__loading">Cargando estado del sistema...</p>
  </ng-template>
</section>
